<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: NoSE::Search::CompletePlanConstraints
  
    &mdash; Documentation by YARD 0.9.25
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "NoSE::Search::CompletePlanConstraints";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../NoSE.html" title="NoSE (module)">NoSE</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Search.html" title="NoSE::Search (module)">Search</a></span></span>
     &raquo; 
    <span class="title">CompletePlanConstraints</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: NoSE::Search::CompletePlanConstraints
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="Constraint.html" title="NoSE::Search::Constraint (class)">Constraint</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="Constraint.html" title="NoSE::Search::Constraint (class)">Constraint</a></span></li>
          
            <li class="next">NoSE::Search::CompletePlanConstraints</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/nose/search/constraints.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Constraints that force each query to have an available plan</p>


  </div>
</div>
<div class="tags">
  

</div>






  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_query_constraints-class_method" title="add_query_constraints (class method)">.<strong>add_query_constraints</strong>(query, q, constraints, problem)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add the discovered constraints to the problem.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#apply_query-class_method" title="apply_query (class method)">.<strong>apply_query</strong>(query, q, problem)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add complete query plan constraints.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="Constraint.html" title="NoSE::Search::Constraint (class)">Constraint</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Constraint.html#apply-class_method" title="NoSE::Search::Constraint.apply (method)">apply</a></span></p>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_query_constraints-class_method">
  
    .<strong>add_query_constraints</strong>(query, q, constraints, problem)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add the discovered constraints to the problem</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/search/constraints.rb', line 57</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_add_query_constraints'>add_query_constraints</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_constraints'>constraints</span><span class='comma'>,</span> <span class='id identifier rubyid_problem'>problem</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_constraints'>constraints</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entities'>entities</span><span class='comma'>,</span> <span class='id identifier rubyid_constraint'>constraint</span><span class='op'>|</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>q</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_q'>q</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:name</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>_</span><span class='tstring_end'>&#39;</span></span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> \
        <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NOSE_LOG</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>debug</span><span class='tstring_end'>&#39;</span></span>

    <span class='comment'># If this is a support query, then we might not need a plan
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><span class='object_link'><a href="../SupportQuery.html" title="NoSE::SupportQuery (class)">SupportQuery</a></span></span>
      <span class='comment'># Find the index associated with the support query and make
</span>      <span class='comment'># the requirement of a plan conditional on this index
</span>      <span class='id identifier rubyid_index_var'>index_var</span> <span class='op'>=</span> <span class='kw'>if</span> <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:by_id_graph</span><span class='rbracket'>]</span>
                    <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_index_vars'>index_vars</span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_to_id_graph'>to_id_graph</span><span class='rbracket'>]</span>
                  <span class='kw'>else</span>
                    <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_index_vars'>index_vars</span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span><span class='rbracket'>]</span>
                  <span class='kw'>end</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_index_var'>index_var</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

      <span class='id identifier rubyid_constr'>constr</span> <span class='op'>=</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>Constraint</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_constraint'>constraint</span> <span class='op'>+</span> <span class='id identifier rubyid_index_var'>index_var</span> <span class='op'>*</span> <span class='op'>-</span><span class='float'>1.0</span><span class='comma'>,</span>
                                      <span class='symbol'>:==</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_constr'>constr</span> <span class='op'>=</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>Constraint</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_constraint'>constraint</span><span class='comma'>,</span> <span class='symbol'>:==</span><span class='comma'>,</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_model'>model</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_constr'>constr</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="apply_query-class_method">
  
    .<strong>apply_query</strong>(query, q, problem)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Add complete query plan constraints</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/search/constraints.rb', line 84</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_apply_query'>apply_query</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_problem'>problem</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_entities'>entities</span> <span class='op'>=</span> <span class='id identifier rubyid_query'>query</span><span class='period'>.</span><span class='id identifier rubyid_join_order'>join_order</span>
  <span class='id identifier rubyid_query_constraints'>query_constraints</span> <span class='op'>=</span> <span class='const'>Hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_each_cons'>each_cons</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_next_e'>next_e</span><span class='op'>|</span>
    <span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='comma'>,</span> <span class='id identifier rubyid_next_e'>next_e</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>LinExpr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rbracket'>]</span>
  <span class='kw'>end</span><span class='rbracket'>]</span>

  <span class='comment'># Add the sentinel entities at the end and beginning
</span>  <span class='id identifier rubyid_last'>last</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Entity.html" title="NoSE::Entity (class)">Entity</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Entity.html#initialize-instance_method" title="NoSE::Entity#initialize (method)">new</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>__LAST__</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='comma'>,</span> <span class='id identifier rubyid_last'>last</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>LinExpr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_first'>first</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Entity.html" title="NoSE::Entity (class)">Entity</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Entity.html#initialize-instance_method" title="NoSE::Entity#initialize (method)">new</a></span></span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>__FIRST__</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_first'>first</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>LinExpr</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span><span class='lbracket'>[</span><span class='symbol'>:costs</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_index'>index</span><span class='comma'>,</span> <span class='lparen'>(</span><span class='id identifier rubyid_steps'>steps</span><span class='comma'>,</span> <span class='id identifier rubyid__'>_</span><span class='rparen'>)</span><span class='op'>|</span>
    <span class='comment'># All indexes should advance a step if possible unless
</span>    <span class='comment'># this is either the last step from IDs to entity
</span>    <span class='comment'># data or the first step going from data to IDs
</span>    <span class='id identifier rubyid_index_step'>index_step</span> <span class='op'>=</span> <span class='id identifier rubyid_steps'>steps</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_fail'>fail</span> <span class='kw'>if</span> <span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_graph'>graph</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> \
            <span class='op'>!</span><span class='lparen'>(</span><span class='id identifier rubyid_steps'>steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_answered?'>answered?</span> <span class='op'>||</span>
              <span class='id identifier rubyid_index_step'>index_step</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Plans/RootPlanStep.html" title="NoSE::Plans::RootPlanStep (class)">RootPlanStep</a></span></span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='comment'># Join each step in the query graph
</span>    <span class='id identifier rubyid_index_var'>index_var</span> <span class='op'>=</span> <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_query_vars'>query_vars</span><span class='lbracket'>[</span><span class='id identifier rubyid_index'>index</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_index_entities'>index_entities</span> <span class='op'>=</span> <span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_graph'>graph</span><span class='period'>.</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entity'>entity</span><span class='op'>|</span>
      <span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_index'>index</span> <span class='id identifier rubyid_entity'>entity</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_index_entities'>index_entities</span><span class='period'>.</span><span class='id identifier rubyid_each_cons'>each_cons</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='id identifier rubyid_next_entity'>next_entity</span><span class='op'>|</span>
      <span class='comment'># Make sure the constraints go in the correct direction
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='id identifier rubyid_next_entity'>next_entity</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_entity'>entity</span><span class='comma'>,</span> <span class='id identifier rubyid_next_entity'>next_entity</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_index_var'>index_var</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_next_entity'>next_entity</span><span class='comma'>,</span> <span class='id identifier rubyid_entity'>entity</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_index_var'>index_var</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># If this query has been answered, add the jump to the last step
</span>    <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='comma'>,</span> <span class='id identifier rubyid_last'>last</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_index_var'>index_var</span> \
      <span class='kw'>if</span> <span class='id identifier rubyid_steps'>steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_answered?'>answered?</span>

    <span class='comment'># If this index is the first step, add this index to the beginning
</span>    <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_entities'>entities</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='comma'>,</span> <span class='id identifier rubyid_first'>first</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>+=</span> <span class='id identifier rubyid_index_var'>index_var</span> \
      <span class='kw'>if</span> <span class='id identifier rubyid_index_step'>index_step</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Plans/RootPlanStep.html" title="NoSE::Plans::RootPlanStep (class)">RootPlanStep</a></span></span><span class='rparen'>)</span>

    <span class='comment'># Ensure the previous index is available
</span>    <span class='id identifier rubyid_parent_index'>parent_index</span> <span class='op'>=</span> <span class='id identifier rubyid_index_step'>index_step</span><span class='period'>.</span><span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_parent_index'>parent_index</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_parent_index'>parent_index</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='id identifier rubyid_parent_var'>parent_var</span> <span class='op'>=</span> <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_query_vars'>query_vars</span><span class='lbracket'>[</span><span class='id identifier rubyid_parent_index'>parent_index</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_query'>query</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>q</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_q'>q</span><span class='embexpr_end'>}</span><span class='tstring_content'>_</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_key'>key</span><span class='embexpr_end'>}</span><span class='tstring_content'>_parent</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>NOSE_LOG</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>debug</span><span class='tstring_end'>&#39;</span></span>
    <span class='id identifier rubyid_constr'>constr</span> <span class='op'>=</span> <span class='const'>MIPPeR</span><span class='op'>::</span><span class='const'>Constraint</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='id identifier rubyid_index_var'>index_var</span> <span class='op'>*</span> <span class='float'>1.0</span> <span class='op'>+</span> <span class='id identifier rubyid_parent_var'>parent_var</span> <span class='op'>*</span> <span class='op'>-</span><span class='float'>1.0</span><span class='comma'>,</span>
                                    <span class='symbol'>:&lt;=</span><span class='comma'>,</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span>
    <span class='id identifier rubyid_problem'>problem</span><span class='period'>.</span><span class='id identifier rubyid_model'>model</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_constr'>constr</span>
  <span class='kw'>end</span>

  <span class='comment'># Ensure we have exactly one index on each component of the query graph
</span>  <span class='id identifier rubyid_add_query_constraints'>add_query_constraints</span> <span class='id identifier rubyid_query'>query</span><span class='comma'>,</span> <span class='id identifier rubyid_q'>q</span><span class='comma'>,</span> <span class='id identifier rubyid_query_constraints'>query_constraints</span><span class='comma'>,</span> <span class='id identifier rubyid_problem'>problem</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jul 16 14:48:21 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.0).
</div>

    </div>
  </body>
</html>