<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: NoSE::Plans::QueryExecutionPlan
  
    &mdash; Documentation by YARD 0.9.25
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "NoSE::Plans::QueryExecutionPlan";
  relpath = '../../';
</script>


  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../../_index.html">Index (Q)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../NoSE.html" title="NoSE (module)">NoSE</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span>
     &raquo; 
    <span class="title">QueryExecutionPlan</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: NoSE::Plans::QueryExecutionPlan
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="AbstractPlan.html" title="NoSE::Plans::AbstractPlan (class)">AbstractPlan</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next"><span class='object_link'><a href="AbstractPlan.html" title="NoSE::Plans::AbstractPlan (class)">AbstractPlan</a></span></li>
          
            <li class="next">NoSE::Plans::QueryExecutionPlan</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  <dl>
      <dt>Extended by:</dt>
      <dd>Forwardable</dd>
  </dl>
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/nose/plans/execution_plan.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>DSL to construct query execution plans</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#group-instance_method" title="#group (instance method)">#<strong>group</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute group.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#index-instance_method" title="#index (instance method)">#<strong>index</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute index.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute name.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#params-instance_method" title="#params (instance method)">#<strong>params</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute params.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#query_plans-instance_method" title="#query_plans (instance method)">#<strong>query_plans</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute query_plans.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#select_fields-instance_method" title="#select_fields (instance method)">#<strong>select_fields</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute select_fields.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#steps-instance_method" title="#steps (instance method)">#<strong>steps</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute steps.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_steps-instance_method" title="#update_steps (instance method)">#<strong>update_steps</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute update_steps.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="AbstractPlan.html" title="NoSE::Plans::AbstractPlan (class)">AbstractPlan</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="AbstractPlan.html#weight-instance_method" title="NoSE::Plans::AbstractPlan#weight (method)">#weight</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cost-instance_method" title="#cost (instance method)">#<strong>cost</strong>  &#x21d2; Fixnum </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>The estimated cost of executing this plan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Delete-instance_method" title="#Delete (instance method)">#<strong>Delete</strong>(index_key)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a new deletion step from an index.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(group, name, schema, plans)  &#x21d2; QueryExecutionPlan </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of QueryExecutionPlan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Insert-instance_method" title="#Insert (instance method)">#<strong>Insert</strong>(index_key, *fields)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add a new insertion step into an index.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Lookup-instance_method" title="#Lookup (instance method)">#<strong>Lookup</strong>(index_key, *conditions, limit: nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Create a new index lookup step with a particular set of conditions.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Param-instance_method" title="#Param (instance method)">#<strong>Param</strong>(field, operator, value = nil)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add parameters which are used as input to the plan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#query-instance_method" title="#query (instance method)">#<strong>query</strong>  &#x21d2; nil </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>These plans have no associated query.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Select-instance_method" title="#Select (instance method)">#<strong>Select</strong>(*fields)  &#x21d2; void </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Identify fields to be selected.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#Support-instance_method" title="#Support (instance method)">#<strong>Support</strong>(&amp;block)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pass the support query up to the parent.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_fields-instance_method" title="#update_fields (instance method)">#<strong>update_fields</strong>  &#x21d2; Array&lt;Fields::Field&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Produce the fields updated by this plan.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(group, name, schema, plans)  &#x21d2; <tt><span class='object_link'><a href="" title="NoSE::Plans::QueryExecutionPlan (class)">QueryExecutionPlan</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of QueryExecutionPlan.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


151
152
153
154
155
156
157
158
159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 151</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_group'>group</span><span class='comma'>,</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_schema'>schema</span><span class='comma'>,</span> <span class='id identifier rubyid_plans'>plans</span><span class='rparen'>)</span>
  <span class='ivar'>@group</span> <span class='op'>=</span> <span class='id identifier rubyid_group'>group</span>
  <span class='ivar'>@name</span> <span class='op'>=</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@schema</span> <span class='op'>=</span> <span class='id identifier rubyid_schema'>schema</span>
  <span class='ivar'>@plans</span> <span class='op'>=</span> <span class='id identifier rubyid_plans'>plans</span>
  <span class='ivar'>@select_fields</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@params</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='ivar'>@steps</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@update_steps</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@query_plans</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="group-instance_method">
  
    #<strong>group</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute group.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_group'>group</span>
  <span class='ivar'>@group</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="index-instance_method">
  
    #<strong>index</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute index.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_index'>index</span>
  <span class='ivar'>@index</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute name.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="params-instance_method">
  
    #<strong>params</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute params.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_params'>params</span>
  <span class='ivar'>@params</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="query_plans=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="query_plans-instance_method">
  
    #<strong>query_plans</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute query_plans.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_query_plans'>query_plans</span>
  <span class='ivar'>@query_plans</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="select_fields-instance_method">
  
    #<strong>select_fields</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute select_fields.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_select_fields'>select_fields</span>
  <span class='ivar'>@select_fields</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="steps-instance_method">
  
    #<strong>steps</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute steps.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_steps'>steps</span>
  <span class='ivar'>@steps</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <div class="method_details ">
  <h3 class="signature " id="update_steps-instance_method">
  
    #<strong>update_steps</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute update_steps.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 142</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_steps'>update_steps</span>
  <span class='ivar'>@update_steps</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cost-instance_method">
  
    #<strong>cost</strong>  &#x21d2; <tt>Fixnum</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>The estimated cost of executing this plan</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Fixnum</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 177</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cost'>cost</span>
  <span class='id identifier rubyid_costs'>costs</span> <span class='op'>=</span> <span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:cost</span><span class='rparen'>)</span> <span class='op'>+</span> <span class='ivar'>@update_steps</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:cost</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_costs'>costs</span> <span class='op'>+=</span> <span class='ivar'>@query_plans</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:steps</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:cost</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_costs'>costs</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbol'>:+</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Delete-instance_method">
  
    #<strong>Delete</strong>(index_key)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add a new deletion step from an index</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 265</span>

<span class='kw'>def</span> <span class='const'>Delete</span><span class='lparen'>(</span><span class='id identifier rubyid_index_key'>index_key</span><span class='rparen'>)</span>
  <span class='ivar'>@index</span> <span class='op'>=</span> <span class='ivar'>@schema</span><span class='period'>.</span><span class='id identifier rubyid_indexes'>indexes</span><span class='lbracket'>[</span><span class='id identifier rubyid_index_key'>index_key</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_step'>step</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="DeletePlanStep.html" title="NoSE::Plans::DeletePlanStep (class)">DeletePlanStep</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="DeletePlanStep.html#initialize-instance_method" title="NoSE::Plans::DeletePlanStep#initialize (method)">new</a></span></span> <span class='ivar'>@index</span>

  <span class='comment'># Get cardinality from last step of each support query plan
</span>  <span class='comment'># as in UpdatePlanner#find_plans_for_update
</span>  <span class='id identifier rubyid_cardinalities'>cardinalities</span> <span class='op'>=</span> <span class='ivar'>@query_plans</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_steps'>steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_cardinality'>cardinality</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_cardinality'>cardinality</span> <span class='op'>=</span> <span class='id identifier rubyid_cardinalities'>cardinalities</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbol'>:*</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='const'>OpenStruct</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='label'>cardinality:</span> <span class='id identifier rubyid_cardinality'>cardinality</span>

  <span class='ivar'>@update_steps</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Insert-instance_method">
  
    #<strong>Insert</strong>(index_key, *fields)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add a new insertion step into an index</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


248
249
250
251
252
253
254
255
256
257
258
259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 248</span>

<span class='kw'>def</span> <span class='const'>Insert</span><span class='lparen'>(</span><span class='id identifier rubyid_index_key'>index_key</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='ivar'>@index</span> <span class='op'>=</span> <span class='ivar'>@schema</span><span class='period'>.</span><span class='id identifier rubyid_indexes'>indexes</span><span class='lbracket'>[</span><span class='id identifier rubyid_index_key'>index_key</span><span class='rbracket'>]</span>

  <span class='comment'># Get cardinality from last step of each support query plan
</span>  <span class='comment'># as in UpdatePlanner#find_plans_for_update
</span>  <span class='id identifier rubyid_cardinalities'>cardinalities</span> <span class='op'>=</span> <span class='ivar'>@query_plans</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_steps'>steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_cardinality'>cardinality</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_cardinality'>cardinality</span> <span class='op'>=</span> <span class='id identifier rubyid_cardinalities'>cardinalities</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='symbol'>:*</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='const'>OpenStruct</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='label'>cardinality:</span> <span class='id identifier rubyid_cardinality'>cardinality</span>

  <span class='id identifier rubyid_fields'>fields</span> <span class='op'>=</span> <span class='ivar'>@index</span><span class='period'>.</span><span class='id identifier rubyid_all_fields'>all_fields</span> <span class='kw'>if</span> <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_step'>step</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="InsertPlanStep.html" title="NoSE::Plans::InsertPlanStep (class)">InsertPlanStep</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="InsertPlanStep.html#initialize-instance_method" title="NoSE::Plans::InsertPlanStep#initialize (method)">new</a></span></span> <span class='ivar'>@index</span><span class='comma'>,</span> <span class='id identifier rubyid_state'>state</span><span class='comma'>,</span> <span class='id identifier rubyid_fields'>fields</span>

  <span class='ivar'>@update_steps</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Lookup-instance_method">
  
    #<strong>Lookup</strong>(index_key, *conditions, limit: nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Create a new index lookup step with a particular set of conditions</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 206</span>

<span class='kw'>def</span> <span class='const'>Lookup</span><span class='lparen'>(</span><span class='id identifier rubyid_index_key'>index_key</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_conditions'>conditions</span><span class='comma'>,</span> <span class='label'>limit:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_index'>index</span> <span class='op'>=</span> <span class='ivar'>@schema</span><span class='period'>.</span><span class='id identifier rubyid_indexes'>indexes</span><span class='lbracket'>[</span><span class='id identifier rubyid_index_key'>index_key</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_step'>step</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plans.html" title="NoSE::Plans (module)">Plans</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="IndexLookupPlanStep.html" title="NoSE::Plans::IndexLookupPlanStep (class)">IndexLookupPlanStep</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="IndexLookupPlanStep.html#initialize-instance_method" title="NoSE::Plans::IndexLookupPlanStep#initialize (method)">new</a></span></span> <span class='id identifier rubyid_index'>index</span>
  <span class='id identifier rubyid_eq_fields'>eq_fields</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_range_field'>range_field</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_conditions'>conditions</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_operator'>operator</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_operator'>operator</span> <span class='op'>==</span> <span class='symbol'>:==</span>
      <span class='id identifier rubyid_eq_fields'>eq_fields</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span> <span class='id identifier rubyid_field'>field</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_range_field'>range_field</span> <span class='op'>=</span> <span class='id identifier rubyid_field'>field</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@eq_filter</span><span class='comma'>,</span> <span class='id identifier rubyid_eq_fields'>eq_fields</span>
  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@range_filter</span><span class='comma'>,</span> <span class='id identifier rubyid_range_field'>range_field</span>

  <span class='comment'># XXX No ordering supported for now
</span>  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@order_by</span><span class='comma'>,</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_set'>instance_variable_set</span> <span class='symbol'>:@limit</span><span class='comma'>,</span> <span class='id identifier rubyid_limit'>limit</span> <span class='kw'>unless</span> <span class='id identifier rubyid_limit'>limit</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='comment'># Cardinality calculations adapted from
</span>  <span class='comment'># IndexLookupPlanStep#update_state
</span>  <span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='const'>OpenStruct</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='kw'>if</span> <span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_hash_cardinality'>hash_cardinality</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_hash_cardinality'>hash_cardinality</span> <span class='op'>=</span> <span class='ivar'>@steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_cardinality'>cardinality</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_cardinality'>cardinality</span> <span class='op'>=</span> <span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_per_hash_count'>per_hash_count</span> <span class='op'>*</span> <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_hash_cardinality'>hash_cardinality</span>
  <span class='id identifier rubyid_state'>state</span><span class='period'>.</span><span class='id identifier rubyid_cardinality'>cardinality</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../Cardinality.html" title="Cardinality (class)">Cardinality</a></span></span><span class='period'>.</span><span class='id identifier rubyid_filter'><span class='object_link'><a href="../../Cardinality.html#filter-class_method" title="Cardinality.filter (method)">filter</a></span></span> <span class='id identifier rubyid_cardinality'>cardinality</span><span class='comma'>,</span>
                                         <span class='id identifier rubyid_eq_fields'>eq_fields</span> <span class='op'>-</span> <span class='id identifier rubyid_index'>index</span><span class='period'>.</span><span class='id identifier rubyid_hash_fields'>hash_fields</span><span class='comma'>,</span>
                                         <span class='id identifier rubyid_range_field'>range_field</span>

  <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span> <span class='op'>=</span> <span class='id identifier rubyid_state'>state</span>

  <span class='ivar'>@steps</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Param-instance_method">
  
    #<strong>Param</strong>(field, operator, value = nil)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Add parameters which are used as input to the plan</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


194
195
196
197</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 194</span>

<span class='kw'>def</span> <span class='const'>Param</span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_operator'>operator</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_operator'>operator</span> <span class='op'>=</span> <span class='symbol'>:&#39;=&#39;</span> <span class='kw'>if</span> <span class='id identifier rubyid_operator'>operator</span> <span class='op'>==</span> <span class='symbol'>:==</span>
  <span class='ivar'>@params</span><span class='lbracket'>[</span><span class='id identifier rubyid_field'>field</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Condition.html" title="NoSE::Condition (class)">Condition</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Condition.html#initialize-instance_method" title="NoSE::Condition#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_field'>field</span><span class='comma'>,</span> <span class='id identifier rubyid_operator'>operator</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="query-instance_method">
  
    #<strong>query</strong>  &#x21d2; <tt>nil</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>These plans have no associated query</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>nil</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_query'>query</span>
  <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Select-instance_method">
  
    #<strong>Select</strong>(*fields)  &#x21d2; <tt>void</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p class="note returns_void">This method returns an undefined value.</p>
<p>Identify fields to be selected</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 188</span>

<span class='kw'>def</span> <span class='const'>Select</span><span class='lparen'>(</span><span class='op'>*</span><span class='id identifier rubyid_fields'>fields</span><span class='rparen'>)</span>
  <span class='ivar'>@select_fields</span> <span class='op'>=</span> <span class='id identifier rubyid_fields'>fields</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_to_set'>to_set</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="Support-instance_method">
  
    #<strong>Support</strong>(&amp;block)  &#x21d2; <tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Pass the support query up to the parent</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 200</span>

<span class='kw'>def</span> <span class='const'>Support</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
  <span class='ivar'>@plans</span><span class='period'>.</span><span class='const'>Support</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_fields-instance_method">
  
    #<strong>update_fields</strong>  &#x21d2; <tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Fields/Field.html" title="NoSE::Fields::Field (class)">Fields::Field</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Produce the fields updated by this plan</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Fields/Field.html" title="NoSE::Fields::Field (class)">Fields::Field</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/nose/plans/execution_plan.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_fields'>update_fields</span>
  <span class='ivar'>@update_steps</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_fields'>fields</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Jul 16 14:56:43 2020 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.25 (ruby-2.7.0).
</div>

    </div>
  </body>
</html>